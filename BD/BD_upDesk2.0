/* DB_Lógico: */

CREATE TABLE Usuario (
    user_ID FLOAT PRIMARY KEY,
    user_Nome VARCHAR,
    user_Email VARCHAR,
    user_Senha VARCHAR
);

CREATE TABLE Chamado (
    chamado_ID FLOAT,
    chamado_Categoria VARCHAR,
    chamado_Descricao VARCHAR,
    user_ID FLOAT,
    fk_IA_ia_ID FLOAT,
    PRIMARY KEY (chamado_ID, user_ID)
);

CREATE TABLE TI (
    ti_Nome VARCHAR,
    ti_ID FLOAT PRIMARY KEY
);

CREATE TABLE Chamado_Info (
    user_ID FLOAT,
    chamado_ID FLOAT,
    user_Email VARCHAR,
    user_nome VARCHAR,
    chamado_anexo BLOB,
    PRIMARY KEY (user_ID, chamado_ID)
);

CREATE TABLE IA (
    ia_Nome VARCHAR,
    ia_ID FLOAT PRIMARY KEY
);

CREATE TABLE Triagem (
    triagem_ID FLOAT PRIMARY KEY,
    triagem_Nome VARCHAR,
    fk_IA_ia_ID FLOAT
);

CREATE TABLE Sugestao_de_solucao_IA (
    ID_procedimento FLOAT PRIMARY KEY,
    Titulo_procedimento VARCHAR,
    fk_IA_ia_ID FLOAT
);

CREATE TABLE Abre (
    fk_Usuario_user_ID FLOAT,
    fk_Chamado_chamado_ID FLOAT,
    fk_Chamado_user_ID FLOAT
);

CREATE TABLE Contem (
    fk_Chamado_Info_user_ID FLOAT,
    fk_Chamado_Info_chamado_ID FLOAT,
    fk_Chamado_chamado_ID FLOAT,
    fk_Chamado_user_ID FLOAT
);

CREATE TABLE Aprova_e_Transfere (
    fk_Triagem_triagem_ID FLOAT,
    fk_TI_ti_ID FLOAT
);

CREATE TABLE Atende (
    fk_TI_ti_ID FLOAT,
    fk_Chamado_chamado_ID FLOAT,
    fk_Chamado_user_ID FLOAT
);
 
ALTER TABLE Chamado ADD CONSTRAINT FK_Chamado_2
    FOREIGN KEY (fk_IA_ia_ID)
    REFERENCES IA (ia_ID)
    ON DELETE CASCADE;
 
ALTER TABLE Triagem ADD CONSTRAINT FK_Triagem_2
    FOREIGN KEY (fk_IA_ia_ID)
    REFERENCES IA (ia_ID)
    ON DELETE CASCADE;
 
ALTER TABLE Sugestao_de_solucao_IA ADD CONSTRAINT FK_Sugestao_de_solucao_IA_2
    FOREIGN KEY (fk_IA_ia_ID)
    REFERENCES IA (ia_ID)
    ON DELETE RESTRICT;
 
ALTER TABLE Abre ADD CONSTRAINT FK_Abre_1
    FOREIGN KEY (fk_Usuario_user_ID)
    REFERENCES Usuario (user_ID)
    ON DELETE RESTRICT;
 
ALTER TABLE Abre ADD CONSTRAINT FK_Abre_2
    FOREIGN KEY (fk_Chamado_chamado_ID, fk_Chamado_user_ID)
    REFERENCES Chamado (chamado_ID, user_ID)
    ON DELETE RESTRICT;
 
ALTER TABLE Contem ADD CONSTRAINT FK_Contem_1
    FOREIGN KEY (fk_Chamado_Info_user_ID, fk_Chamado_Info_chamado_ID)
    REFERENCES Chamado_Info (user_ID, chamado_ID)
    ON DELETE SET NULL;
 
ALTER TABLE Contem ADD CONSTRAINT FK_Contem_2
    FOREIGN KEY (fk_Chamado_chamado_ID, fk_Chamado_user_ID)
    REFERENCES Chamado (chamado_ID, user_ID)
    ON DELETE SET NULL;
 
ALTER TABLE Aprova_e_Transfere ADD CONSTRAINT FK_Aprova_e_Transfere_1
    FOREIGN KEY (fk_Triagem_triagem_ID)
    REFERENCES Triagem (triagem_ID)
    ON DELETE RESTRICT;
 
ALTER TABLE Aprova_e_Transfere ADD CONSTRAINT FK_Aprova_e_Transfere_2
    FOREIGN KEY (fk_TI_ti_ID)
    REFERENCES TI (ti_ID)
    ON DELETE SET NULL;
 
ALTER TABLE Atende ADD CONSTRAINT FK_Atende_1
    FOREIGN KEY (fk_TI_ti_ID)
    REFERENCES TI (ti_ID)
    ON DELETE RESTRICT;
 
ALTER TABLE Atende ADD CONSTRAINT FK_Atende_2
    FOREIGN KEY (fk_Chamado_chamado_ID, fk_Chamado_user_ID)
    REFERENCES Chamado (chamado_ID, user_ID)
    ON DELETE RESTRICT;